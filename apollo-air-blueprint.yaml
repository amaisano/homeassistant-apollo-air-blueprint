blueprint:
  name: Apollo Air Sensor Notification
  description: >
    This blueprint monitors values from Apollo Air sensors and sends a notification if any values exceed the defined thresholds.
  domain: automation
  input:
    notification_target:
      name: Notification Target
      description: Select the target for notifications.
      default: false
      selector:
        device:
          integration: mobile_app
          multiple: true

    temperature_settings:
      name: Temperature
      icon: mdi:thermometer
      collapsed: true
      input:
        temperature_sensor:
          name: Temperature Sensor
          description: "Select the temperature sensor."
          default: null
          selector:
            entity:
              integration: esphome
              domain: sensor
              device_class: temperature
        min_temp:
          name: Minimum Temperature
          description: "Set the minimum acceptable temperature (°C)."
          default: 15
          selector:
            number:
              min: -10
              max: 50
              unit_of_measurement: °C
        max_temp:
          name: Maximum Temperature
          description: "Set the maximum acceptable temperature (°C)."
          default: 30
          selector:
            number:
              min: -10
              max: 50
              unit_of_measurement: °C

    humidity_settings:
      name: Humidity
      icon: mdi:water-percent
      collapsed: true
      input:
        humidity_sensor:
          name: Humidity Sensor
          description: "Select the humidity sensor."
          default: null
          selector:
            entity:
              integration: esphome
              domain: sensor
              device_class: humidity
        min_humidity:
          name: Minimum Humidity
          description: "Set the minimum acceptable humidity (%)."
          default: 30
          selector:
            number:
              min: 0
              max: 100
              unit_of_measurement: "%"
        max_humidity:
          name: Maximum Humidity
          description: "Set the maximum acceptable humidity (%)."
          default: 60
          selector:
            number:
              min: 0
              max: 100
              unit_of_measurement: "%"

    pressure_settings:
      name: Pressure
      icon: mdi:gauge
      collapsed: true
      input:
        pressure_sensor:
          name: Pressure Sensor
          description: "Select the pressure sensor."
          default: null
          selector:
            entity:
              integration: esphome
              domain: sensor
              device_class: pressure
        min_pressure:
          name: Minimum Pressure
          description: "Set the minimum acceptable pressure (hPa)."
          default: 980
          selector:
            number:
              min: 800
              max: 1200
              unit_of_measurement: hPa
        max_pressure:
          name: Maximum Pressure
          description: "Set the maximum acceptable pressure (hPa)."
          default: 1050
          selector:
            number:
              min: 800
              max: 1200
              unit_of_measurement: hPa

    pm1_settings:
      name: PM1
      icon: mdi:weather-fog
      collapsed: true
      input:
        pm1_sensor:
          name: PM1 Sensor
          description: "Select the PM1 sensor."
          default: null
          selector:
            entity:
              integration: esphome
              domain: sensor
        max_pm1:
          name: Maximum PM1
          description: "Set the maximum acceptable PM1 level (µg/m³)."
          default: 10
          selector:
            number:
              min: 0
              max: 500
              unit_of_measurement: µg/m³

    pm25_settings:
      name: PM2.5
      icon: mdi:weather-fog
      collapsed: true
      input:
        pm25_sensor:
          name: PM2.5 Sensor
          description: "Select the PM2.5 sensor."
          default: null
          selector:
            entity:
              integration: esphome
              domain: sensor
        max_pm25:
          name: Maximum PM2.5
          description: "Set the maximum acceptable PM2.5 level (µg/m³)."
          default: 25
          selector:
            number:
              min: 0
              max: 500
              unit_of_measurement: µg/m³

    pm4_settings:
      name: PM4
      icon: mdi:weather-fog
      collapsed: true
      input:
        pm4_sensor:
          name: PM4 Sensor
          description: "Select the PM4 sensor."
          default: null
          selector:
            entity:
              integration: esphome
              domain: sensor
        max_pm4:
          name: Maximum PM4
          description: "Set the maximum acceptable PM4 level (µg/m³)."
          default: 40
          selector:
            number:
              min: 0
              max: 500
              unit_of_measurement: µg/m³

    pm10_settings:
      name: PM10
      icon: mdi:weather-fog
      collapsed: true
      input:
        pm10_sensor:
          name: PM10 Sensor
          description: "Select the PM10 sensor."
          default: null
          selector:
            entity:
              integration: esphome
              domain: sensor
        max_pm10:
          name: Maximum PM10
          description: "Set the maximum acceptable PM10 level (µg/m³)."
          default: 50
          selector:
            number:
              min: 0
              max: 500
              unit_of_measurement: µg/m³

    voc_settings:
      name: VOC
      icon: mdi:chemical-weapon
      collapsed: true
      input:
        voc_sensor:
          name: VOC Sensor
          description: "Select the VOC sensor."
          default: null
          selector:
            entity:
              integration: esphome
              domain: sensor
        max_voc:
          name: Maximum VOC
          description: "Set the maximum acceptable VOC level (ppb)."
          default: 400
          selector:
            number:
              min: 0
              max: 1000
              unit_of_measurement: ppb

    nox_settings:
      name: NOx
      icon: mdi:weather-lightning
      collapsed: true
      input:
        nox_sensor:
          name: NOx Sensor
          description: "Select the NOx sensor."
          default: null
          selector:
            entity:
              integration: esphome
              domain: sensor
        max_nox:
          name: Maximum NOx
          description: "Set the maximum acceptable NOx level (ppb)."
          default: 30
          selector:
            number:
              min: 0
              max: 100
              unit_of_measurement: ppb

    co2_settings:
      name: CO2
      icon: mdi:molecule-co2
      collapsed: true
      input:
        co2_sensor:
          name: CO2 Sensor
          description: "Select the CO2 sensor."
          default: null
          selector:
            entity:
              integration: esphome
              domain: sensor
              device_class: carbon_dioxide
        max_co2:
          name: Maximum CO2
          description: "Set the maximum acceptable CO2 level (ppm)."
          default: 1000
          selector:
            number:
              min: 0
              max: 5000
              unit_of_measurement: ppm

    co_settings:
      name: CO
      icon: mdi:molecule-co
      collapsed: true
      input:
        co_sensor:
          name: CO Sensor
          description: "Select the CO sensor."
          default: null
          selector:
            entity:
              integration: esphome
              domain: sensor
              device_class: carbon_monoxide
        max_co:
          name: Maximum CO
          description: "Set the maximum acceptable CO level (ppm)."
          default: 10
          selector:
            number:
              min: 0
              max: 100
              unit_of_measurement: ppm

    ethanol_settings:
      name: Ethanol
      icon: mdi:glass-wine
      collapsed: true
      input:
        ethanol_sensor:
          name: Ethanol Sensor
          description: "Select the ethanol sensor."
          default: null
          selector:
            entity:
              integration: esphome
              domain: sensor
        max_ethanol:
          name: Maximum Ethanol
          description: "Set the maximum acceptable ethanol level (ppb)."
          default: 50
          selector:
            number:
              min: 0
              max: 500
              unit_of_measurement: ppb

    hydrogen_settings:
      name: Hydrogen
      icon: mdi:gas-cylinder
      collapsed: true
      input:
        hydrogen_sensor:
          name: Hydrogen Sensor
          description: "Select the hydrogen sensor."
          default: null
          selector:
            entity:
              integration: esphome
              domain: sensor
        max_hydrogen:
          name: Maximum Hydrogen
          description: "Set the maximum acceptable hydrogen level (ppm)."
          default: 1
          selector:
            number:
              min: 0
              max: 10
              unit_of_measurement: ppm

    no2_settings:
      name: NO2
      icon: mdi:gas-cylinder
      collapsed: true
      input:
        no2_sensor:
          name: NO2 Sensor
          description: "Select the NO2 sensor."
          default: null
          selector:
            entity:
              integration: esphome
              domain: sensor
        max_no2:
          name: Maximum NO2
          description: "Set the maximum acceptable NO2 level (ppb)."
          default: 20
          selector:
            number:
              min: 0
              max: 200
              unit_of_measurement: ppb

    ammonia_settings:
      name: Ammonia
      icon: mdi:chemical-weapon
      collapsed: true
      input:
        ammonia_sensor:
          name: Ammonia Sensor
          description: "Select the ammonia sensor."
          default: null
          selector:
            entity:
              integration: esphome
              domain: sensor
        max_ammonia:
          name: Maximum Ammonia
          description: "Set the maximum acceptable ammonia level (ppm)."
          default: 10
          selector:
            number:
              min: 0
              max: 50
              unit_of_measurement: ppm

    methane_settings:
      name: Methane
      icon: mdi:chemical-weapon
      collapsed: true
      input:
        methane_sensor:
          name: Methane Sensor
          description: "Select the methane sensor."
          default: null
          selector:
            entity:
              integration: esphome
              domain: sensor
        max_methane:
          name: Maximum Methane
          description: "Set the maximum acceptable methane level (ppm)."
          default: 10
          selector:
            number:
              min: 0
              max: 50
              unit_of_measurement: ppm

    bluetooth_settings:
      name: Bluetooth Devices
      icon: mdi:bluetooth
      collapsed: true
      input:
        bluetooth_sensor:
          name: Bluetooth Sensor
          description: "Select the Bluetooth sensor."
          default: null
          selector:
            entity:
              integration: esphome
              domain: sensor
        max_bluetooth:
          name: Maximum Bluetooth Devices
          description: "Set the maximum number of Bluetooth devices allowed in range."
          default: 5
          selector:
            number:
              min: 0
              max: 50

    aqi_settings:
      name: Air Quality Index
      icon: mdi:air-filter
      collapsed: true
      input:
        aqi_sensor:
          name: AQI Sensor
          description: "Select the AQI sensor."
          default: null
          selector:
            entity:
              integration: esphome
              domain: sensor
        max_aqi:
          name: Maximum AQI
          description: "Set the maximum acceptable Air Quality Index value."
          default: 100
          selector:
            number:
              min: 0
              max: 500

trigger:
  # Temperature triggers
  - platform: numeric_state
    entity_id: !input temperature_sensor
    above: !input max_temp
    for:
      minutes: 1
    id: "temperature_high"
  - platform: numeric_state
    entity_id: !input temperature_sensor
    below: !input min_temp
    for:
      minutes: 1
    id: "temperature_low"

  # Humidity triggers
  - platform: numeric_state
    entity_id: !input humidity_sensor
    above: !input max_humidity
    for:
      minutes: 1
    id: "humidity_high"
  - platform: numeric_state
    entity_id: !input humidity_sensor
    below: !input min_humidity
    for:
      minutes: 1
    id: "humidity_low"

  # Pressure triggers
  - platform: numeric_state
    entity_id: !input pressure_sensor
    above: !input max_pressure
    for:
      minutes: 1
    id: "pressure_high"
  - platform: numeric_state
    entity_id: !input pressure_sensor
    below: !input min_pressure
    for:
      minutes: 1
    id: "pressure_low"

  # PM1 triggers
  - platform: numeric_state
    entity_id: !input pm1_sensor
    above: !input max_pm1
    for:
      minutes: 1
    id: "pm1_high"

  # PM2.5 triggers
  - platform: numeric_state
    entity_id: !input pm25_sensor
    above: !input max_pm25
    for:
      minutes: 1
    id: "pm25_high"

  # PM4 triggers
  - platform: numeric_state
    entity_id: !input pm4_sensor
    above: !input max_pm4
    for:
      minutes: 1
    id: "pm4_high"

  # PM10 triggers
  - platform: numeric_state
    entity_id: !input pm10_sensor
    above: !input max_pm10
    for:
      minutes: 1
    id: "pm10_high"

  # VOC triggers
  - platform: numeric_state
    entity_id: !input voc_sensor
    above: !input max_voc
    for:
      minutes: 1
    id: "voc_high"

  # NOx triggers
  - platform: numeric_state
    entity_id: !input nox_sensor
    above: !input max_nox
    for:
      minutes: 1
    id: "nox_high"

  # CO2 triggers
  - platform: numeric_state
    entity_id: !input co2_sensor
    above: !input max_co2
    for:
      minutes: 1
    id: "co2_high"

  # CO triggers
  - platform: numeric_state
    entity_id: !input co_sensor
    above: !input max_co
    for:
      minutes: 1
    id: "co_high"

  # Ethanol triggers
  - platform: numeric_state
    entity_id: !input ethanol_sensor
    above: !input max_ethanol
    for:
      minutes: 1
    id: "ethanol_high"

  # Hydrogen triggers
  - platform: numeric_state
    entity_id: !input hydrogen_sensor
    above: !input max_hydrogen
    for:
      minutes: 1
    id: "hydrogen_high"

  # NO2 triggers
  - platform: numeric_state
    entity_id: !input no2_sensor
    above: !input max_no2
    for:
      minutes: 1
    id: "no2_high"

  # Ammonia triggers
  - platform: numeric_state
    entity_id: !input ammonia_sensor
    above: !input max_ammonia
    for:
      minutes: 1
    id: "ammonia_high"

  # Methane triggers
  - platform: numeric_state
    entity_id: !input methane_sensor
    above: !input max_methane
    for:
      minutes: 1
    id: "methane_high"

  # Bluetooth triggers
  - platform: numeric_state
    entity_id: !input bluetooth_sensor
    above: !input max_bluetooth
    for:
      minutes: 1
    id: "bluetooth_high"

  # AQI triggers
  - platform: numeric_state
    entity_id: !input aqi_sensor
    above: !input max_aqi
    for:
      minutes: 1
    id: "aqi_high"

action:
  - choose:
      # Temperature actions
      - conditions:
          - condition: trigger
            id: "temperature_high"
        sequence:
          - service: notify.mobile_app
            data:
              title: "Temperature Alert"
              message: "The temperature is too high! Current value: {{ states(trigger.entity_id) }}°C."
              data:
                icon: mdi:thermometer
      - conditions:
          - condition: trigger
            id: "temperature_low"
        sequence:
          - service: notify.mobile_app
            data:
              title: "Temperature Alert"
              message: "The temperature is too low! Current value: {{ states(trigger.entity_id) }}°C."
              data:
                icon: mdi:thermometer

      # Humidity actions
      - conditions:
          - condition: trigger
            id: "humidity_high"
        sequence:
          - service: notify.mobile_app
            data:
              title: "Humidity Alert"
              message: "The humidity is too high! Current value: {{ states(trigger.entity_id) }}%."
              data:
                icon: mdi:water-percent
      - conditions:
          - condition: trigger
            id: "humidity_low"
        sequence:
          - service: notify.mobile_app
            data:
              title: "Humidity Alert"
              message: "The humidity is too low! Current value: {{ states(trigger.entity_id) }}%."
              data:
                icon: mdi:water-percent

      # Pressure actions
      - conditions:
          - condition: trigger
            id: "pressure_high"
        sequence:
          - service: notify.mobile_app
            data:
              title: "Pressure Alert"
              message: "The pressure is too high! Current value: {{ states(trigger.entity_id) }} hPa."
              data:
                icon: mdi:gauge
      - conditions:
          - condition: trigger
            id: "pressure_low"
        sequence:
          - service: notify.mobile_app
            data:
              title: "Pressure Alert"
              message: "The pressure is too low! Current value: {{ states(trigger.entity_id) }} hPa."
              data:
                icon: mdi:gauge

      # PM1 actions
      - conditions:
          - condition: trigger
            id: "pm1_high"
        sequence:
          - service: notify.mobile_app
            data:
              title: "PM1 Alert"
              message: "PM1 levels are too high! Current value: {{ states(trigger.entity_id) }} µg/m³."
              data:
                icon: mdi:weather-fog

      # PM2.5 actions
      - conditions:
          - condition: trigger
            id: "pm25_high"
        sequence:
          - service: notify.mobile_app
            data:
              title: "PM2.5 Alert"
              message: "PM2.5 levels are too high! Current value: {{ states(trigger.entity_id) }} µg/m³."
              data:
                icon: mdi:weather-fog

      # PM4 actions
      - conditions:
          - condition: trigger
            id: "pm4_high"
        sequence:
          - service: notify.mobile_app
            data:
              title: "PM4 Alert"
              message: "PM4 levels are too high! Current value: {{ states(trigger.entity_id) }} µg/m³."
              data:
                icon: mdi:weather-fog

      # PM10 actions
      - conditions:
          - condition: trigger
            id: "pm10_high"
        sequence:
          - service: notify.mobile_app
            data:
              title: "PM10 Alert"
              message: "PM10 levels are too high! Current value: {{ states(trigger.entity_id) }} µg/m³."
              data:
                icon: mdi:weather-fog

      # VOC actions
      - conditions:
          - condition: trigger
            id: "voc_high"
        sequence:
          - service: notify.mobile_app
            data:
              title: "VOC Alert"
              message: "VOC levels are too high! Current value: {{ states(trigger.entity_id) }} ppb."
              data:
                icon: mdi:chemical-weapon

      # NOx actions
      - conditions:
          - condition: trigger
            id: "nox_high"
        sequence:
          - service: notify.mobile_app
            data:
              title: "NOx Alert"
              message: "NOx levels are too high! Current value: {{ states(trigger.entity_id) }} ppb."
              data:
                icon: mdi:weather-lightning

      # CO2 actions
      - conditions:
          - condition: trigger
            id: "co2_high"
        sequence:
          - service: notify.mobile_app
            data:
              title: "CO2 Alert"
              message: "CO2 levels are too high! Current value: {{ states(trigger.entity_id) }} ppm."
              data:
                icon: mdi:molecule-co2

      # CO actions
      - conditions:
          - condition: trigger
            id: "co_high"
        sequence:
          - service: notify.mobile_app
            data:
              title: "CO Alert"
              message: "CO levels are too high! Current value: {{ states(trigger.entity_id) }} ppm."
              data:
                icon: mdi:molecule-co

      # Ethanol actions
      - conditions:
          - condition: trigger
            id: "ethanol_high"
        sequence:
          - service: notify.mobile_app
            data:
              title: "Ethanol Alert"
              message: "Ethanol levels are too high! Current value: {{ states(trigger.entity_id) }} ppb."
              data:
                icon: mdi:glass-wine

      # Hydrogen actions
      - conditions:
          - condition: trigger
            id: "hydrogen_high"
        sequence:
          - service: notify.mobile_app
            data:
              title: "Hydrogen Alert"
              message: "Hydrogen levels are too high! Current value: {{ states(trigger.entity_id) }} ppm."
              data:
                icon: mdi:gas-cylinder

      # NO2 actions
      - conditions:
          - condition: trigger
            id: "no2_high"
        sequence:
          - service: notify.mobile_app
            data:
              title: "NO2 Alert"
              message: "NO2 levels are too high! Current value: {{ states(trigger.entity_id) }} ppb."
              data:
                icon: mdi:gas-cylinder

      # Ammonia actions
      - conditions:
          - condition: trigger
            id: "ammonia_high"
        sequence:
          - service: notify.mobile_app
            data:
              title: "Ammonia Alert"
              message: "Ammonia levels are too high! Current value: {{ states(trigger.entity_id) }} ppm."
              data:
                icon: mdi:chemical-weapon

      # Methane actions
      - conditions:
          - condition: trigger
            id: "methane_high"
        sequence:
          - service: notify.mobile_app
            data:
              title: "Methane Alert"
              message: "Methane levels are too high! Current value: {{ states(trigger.entity_id) }} ppm."
              data:
                icon: mdi:chemical-weapon

      # Bluetooth actions
      - conditions:
          - condition: trigger
            id: "bluetooth_high"
        sequence:
          - service: notify.mobile_app
            data:
              title: "Bluetooth Devices Alert"
              message: "Too many Bluetooth devices detected! Current count: {{ states(trigger.entity_id) }}."
              data:
                icon: mdi:bluetooth

      # AQI actions
      - conditions:
          - condition: trigger
            id: "aqi_high"
        sequence:
          - service: notify.mobile_app
            data:
              title: "Air Quality Index Alert"
              message: "Air Quality Index (AQI) is too high! Current value: {{ states(trigger.entity_id) }}."
              data:
                icon: mdi:air-filter

    default: []
